# 検証結果

本ドキュメントでは、1D PNP ソルバーの検証結果を示す。

## 格子収束性解析

数値解の精度を検証するため、Gouy-Chapman 解析解との比較による格子収束性解析を実施。

### テスト条件

- バルク濃度: c₀ = 0.001 mol/L（Debye 長 ≈ 11.9 nm）
- 表面電位: φ₀ = 50 mV
- 計算領域: L = 50 nm
- グリッド: 一様グリッド（`--stretch 1.0`）

### 結果

| グリッド点数 N | グリッド幅 Δx [nm] | L2 誤差 [mV] | 収束次数 p |
|:--------------:|:------------------:|:------------:|:----------:|
| 51 | 1.0000 | 0.0421 | — |
| 101 | 0.5000 | 0.0109 | 1.97 |
| 201 | 0.2500 | 0.00277 | 2.00 |
| 401 | 0.1250 | 0.000694 | 2.00 |
| 801 | 0.0625 | 0.000174 | 2.00 |
| 1601 | 0.0312 | 4.60e-05 | 1.92 |

**収束次数（平均）: 1.97**（理論値 2.00 と良好に一致）

### 考察

- グリッドを2倍に細かくすると、誤差は約4分の1に減少（2次精度の特徴）
- N ≥ 201 で理論的な2次精度（p ≈ 2）を達成
- 2次精度中心差分法の理論通りの収束性を確認

---

## 包括的検証

様々な物理パラメータ条件下でのソルバーの2次精度収束を検証。

| テスト名 | c₀ [M] | φ₀ [mV] | L [nm] | εᵣ | stretch | 収束次数 | 判定 |
|:---------|:------:|:-------:|:------:|:---:|:-------:|:--------:|:----:|
| baseline | 0.001 | 50 | 100 | 12 | 1.0 | 2.00 | PASS |
| c0-0.0001M | 0.0001 | 50 | 500 | 12 | 1.0 | 2.00 | PASS |
| c0-0.01M | 0.01 | 50 | 100 | 12 | 1.0 | 1.99 | PASS |
| c0-0.1M | 0.1 | 50 | 100 | 12 | 1.0 | 1.93 | PASS |
| phi-100mV | 0.001 | 100 | 100 | 12 | 1.0 | 2.00 | PASS |
| phi-200mV | 0.001 | 200 | 100 | 12 | 1.0 | 1.85 | WARN |
| stretch-3.0 | 0.001 | 50 | 100 | 12 | 3.0 | 1.99 | PASS |
| eps-80 | 0.001 | 50 | 300 | 80 | 1.0 | 1.99 | PASS |

**判定基準**: PASS (1.9 ≤ p ≤ 2.1), WARN (1.5 ≤ p < 1.9)

### 知見

1. **領域サイズ**: L/λD ≥ 20〜30 で安定した2次精度を達成
2. **高電位**: φ₀ = 200 mV（~8kT/e）ではより細かいグリッドが必要
3. **非一様グリッド**: stretch = 2〜3 でも2次精度を維持

---

## Gouy-Chapman 理論との比較

### テスト条件

c₀ = 0.001 M, φ₀ = 50 mV, ε_r = 12

### 結果

| パラメータ | 値 |
|:-----------|------:|
| Debye 長 | 11.9 nm |
| 熱電圧 | 25.7 mV |
| 無次元電位 ψ₀ | 1.95 |
| L2 誤差 | 0.0066 mV |
| 相対 L2 誤差 | 0.16 % |
| 収束反復数 | 4 回 |

数値解と解析解は非常に良く一致。

---

## 電荷・キャパシタンス検証

### 条件

- 両電極モデル（closed system）
- φ_L = 100 mV, φ_R = 0 mV
- c₀ = 1 M, L = 50 nm

### 結果

| 項目 | 左電極 | 右電極 |
|------|-------:|-------:|
| 表面電位 [mV] | 100 | 0 |
| 表面電荷 [μC/cm²] | +5.13 | -5.13 |
| 微分容量 [μF/cm²] | 102.6 | 102.6 |

**電荷中性**: Σσ ≈ 0（誤差 < 10⁻¹¹ μC/cm²）

**直列容量**: C_total = 51.3 μF/cm²

### 電圧-電荷特性

| 印加電圧 [mV] | Standard PB [μC/cm²] | Gouy-Chapman [μC/cm²] | 誤差 [%] | Bikerman [μC/cm²] |
|:-------------:|:--------------------:|:---------------------:|:--------:|:-----------------:|
| 50 | 2.32 | 2.32 | 0.0 | 2.21 |
| 100 | 5.20 | 5.21 | -0.1 | 4.32 |
| 150 | 9.33 | 9.35 | -0.2 | 6.16 |
| 200 | 15.68 | 15.74 | -0.4 | 7.78 |
| 300 | 41.43 | 42.39 | -2.3 | 10.44 |

**条件**: N = 4001, stretch = 3.0（非一様グリッド）

Standard PB は Gouy-Chapman 解析解と良好に一致（300 mV でも誤差 2.3%）。Bikerman は飽和傾向を示し、理論と一致。

---

## 高電圧での格子収束性

高電圧条件（300 mV、c₀ = 1 M）での表面電荷計算の格子収束性を検証。

### 条件

- 両電極モデル（closed system）
- c₀ = 1 M（Debye 長 ≈ 0.12 nm）
- stretch = 3.0（非一様グリッド）

### 結果

| N | σ [μC/cm²] | 誤差 [%] |
|:---:|:----------:|:--------:|
| 1001 | 35.60 | -16.0 |
| 2001 | 39.57 | -6.7 |
| 4001 | 41.43 | -2.3 |

**解析解**: σ = 42.39 μC/cm²

### 知見

1. **高電圧・高濃度では細かいグリッドが必要**: Debye 長が短い（~0.12 nm）ため、EDL内の急激な電位勾配を解像するには N ≥ 4001 が推奨
2. **グリッドストレッチングは必須**: 一様グリッドでは界面付近の分解能が不足
3. **300 mV 以下では N = 4001 で十分な精度**（誤差 < 3%）

---

## Bikerman モデル格子収束性

Bikerman モデルの表面電荷を解析解と比較し、格子収束性を検証。

### 解析解

Bikerman 方程式の第一積分から表面電荷が解析的に計算できる：

$$\sigma = \sqrt{2\varepsilon k_B T c_0 N_A} \cdot \sqrt{\frac{2}{\nu}\ln(1 - \nu + \nu\cosh\psi_0)}$$

### テスト条件

- 印加電圧: 100 mV（両電極、closed system）
- バルク濃度: c₀ = 1 M
- イオンサイズ: a = 0.7 nm（ν = 0.413）
- グリッド: 非一様（stretch = 3.0）

### 結果

| N | σ_num [μC/cm²] | 誤差 [%] | 収束次数 |
|:---:|:---:|:---:|:---:|
| 101 | 3.698 | -13.9 | — |
| 201 | 4.127 | -3.9 | 1.82 |
| 401 | 4.254 | -1.0 | 1.98 |
| 801 | 4.286 | -0.25 | 2.01 |
| 1601 | 4.294 | -0.06 | 2.01 |
| 3201 | 4.296 | -0.02 | 2.01 |

**解析解**: σ = 4.2968 μC/cm²

**平均収束次数**: 1.97（理論値 2.00 と良好に一致）

### 結論

Bikerman モデルも Standard PB と同様に **2次精度** を達成。N ≥ 401 で誤差 1% 以下。

---

## モデルの適用限界

### イオン液体での注意

1 M イオン液体では：
- Debye 長 λD ≈ 0.12 nm
- イオン直径 ≈ 0.5〜0.8 nm
- **λD < イオン直径** → 連続体仮定の限界

### 推奨パラメータ範囲

| パラメータ | 推奨範囲 | 備考 |
|-----------|---------|------|
| 濃度 c₀ | 0.001〜1 M | 高濃度では平均場近似が破綻 |
| 表面電位 φ₀ | ≲ 100 mV | 高電位では Bikerman 推奨 |
| イオン価数 | ±1 | 多価イオンでは静電相関が重要 |
| 計算領域 L | ≥ 10λD | バルク条件の成立に必要 |
